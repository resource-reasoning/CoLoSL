\newpage	
\begin{lemma}[]\label{lem:amodWitness}
%
\[
\begin{array}{l}
	\for{\amod{}, \amod{0} \in \AMods} \for{F_0, F \in \pset{\LState}} \for{ L \in \pset{\AMods}} \for{s, s_0}\\
	\hspace*{0.2cm} s_0 \in F_0 \;\land\; F_0 \strictfences \amod{0} \;\land\; s \in F \;\land\; \left(\for{\amod{L} \in L}  \dom{\amod{L}} \disjoint \dom{\amod{0}} \;\land\; F \strictfences \amod{L}\right) \implies \\
	\hspace*{0.5cm} \exsts{\amod{}'} 
	 \extendsAM{\amod{}', L \cup \{\amod{0}\}}{s_0}{s}{\amod{0}} \;\land\;
	 \extendsAM{\amod{}', L \cup \{\amod{0}\}}{s}{s_0}{\bigcup\limits_{\amod{i} \in L} \amod{i}}

\end{array}
\]
%
\begin{proof}
Pick arbitrary $\amod{}$, $\amod{0}, F_0, F, L, s_0, s$ and $\amod{L} \in L$ such that 
%
\begin{align}
		&s_0 \in F_0 \;\land\; F_0 \strictfences \amod{0} \label{LAW:AssFence}\\
		& \left(\for{\amod{L} \in L}  \dom{\amod{L}} \disjoint \dom{\amod{0}} \;\land\; F \strictfences \amod{L}\right) \label{LAW:dd}\\
		& s \in F \label{LAW:sfence}
\end{align}
%
Let
%
\[
	F' \eqdef
	\left\{
		f_0 \composeL f \;|\;
		f_0 \in F_0 \;\land\;  f \in F
	\right\}
\]
%
and pick  $\amod{}', \amod{0}'$ such that for each $\ca{} \in \Caps$:
%
\[
\amod{}'(\ca{}) =
\left\{
	\begin{array}{l | l}
		(s_1 \composeL d \composeL f_0, s_2 \composeL d \composeL f_0)
		&
		\begin{array}{l}
			\hspace*{-0.2cm} \exsts{f \in F} \exsts{f_0 \in F_0} \exsts{f' \in F'}\\
			f' = f_0 \composeL  f\\
			\exsts{\amod{L} \in L} (s_1 \composeL c, s_2 \composeL c) \in \amod{L}(\ca{})\\
			\for{s'} s' \leq s_1 \;\land\; s' \leq s_2 \implies s' = \unitL\\
			s_1 \composeL d = f \;\land\; s_1 \composeL c \leq f'\\
			s_2 \composeL d \composeL f_0 \hspace*{0.2cm} \text{is defined}
		\end{array}
	\end{array}
\right\}
\]
%
and
%
\[
\amod{0}'(\ca{}) =
\left\{
	\begin{array}{l | l}
		(s_1 \composeL d \composeL f, s_2 \composeL d \composeL f)
		&
		\begin{array}{l}
			\hspace*{-0.2cm} \exsts{f \in F} \exsts{f_0 \in F_0} \exsts{f' \in F'}\\
			f' = f_0 \composeL  f\\
			(s_1 \composeL c, s_2 \composeL c) \in \amod{0}(\ca{})\\
			\for{s'} s' \leq s_1 \;\land\; s' \leq s_2 \implies s' = \unitL\\
			s_1 \composeL d = f_0 \;\land\; s_1 \composeL c \leq f'\\
			s_2 \composeL d \composeL f \hspace*{0.2cm} \text{is defined}
		\end{array}
	\end{array}
\right\}
\]
%
Let 
%
\begin{align}
	\amod{}' = \amod{0}' \cup \amod{1}' \label{LAW:Ass1}
\end{align}
%(\ref{LAW:Ass})
\noindent\textbf{Show}
\begin{align}
	&\for{\amod{L} \in L \cup \{\amod{0}\}} F' \strictfences \amod{L} \label{LAW:Goal1}\\
	&s \composeL s_0 \in F' \label{LAW:Goal2}\\
	&\for{n \in \Nats}\for{s \in F} \for{s_0 \in F_0}  s \composeL s_0 \text{ is defined} \implies \nonumber\\
	& \extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{n}{s}{s_0}{\bigcup\limits_{\amod{i} \in L} \amod{i}} \label{LAW:Goal4}\\
	&\for{n \in \Nats}\for{s \in F} \for{s_0 \in F_0} s \composeL s_0 \text{ is defined} \implies   \extendsAMUpto{\amod{}', L \cup \{ \amod{0}\}}{n}{s_0}{s}{\amod{0}} \label{LAW:Goal5}
\end{align}
%
\textbf{RTS. (\ref{LAW:Goal5})}\\
\begin{proof}
By induction on the number of steps $m$.\\

\noindent\textbf{Base Case}\\
\textbf{RTS. } $\extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{0}{s_0}{l' \composeL r'}{\amod{0}}$\\
This holds trivially by definition of $-\downarrow_{0}$.\\

\noindent\textbf{Inductive Case}\\
\textbf{Assume}
\begin{align}
%	\begin{array}{l }
%		\exsts{s} l_1 \composeL  \cdots \composeL l_n = s \\
%	  \land\; \for{\amod{j}, \amod{k} \in \left(\amod{1} \cup \cdots \cup \amod{n}\right)} \dom{\amod{j}} \disjoint \dom{\amod{k}} \\
%	  \land\; \for{j \in 1, \cdots, n} l_j \in F_j  \;\land\; F_i \strictfences \amod{i} \\
%	  \hspace*{3cm} \implies\\
%	  \extendsAMUpto{\amod{}}{m-1}{l_i}{l_1 \composeL \cdots \composeL l_{i-1} \composeL l_{i+1} \composeL \cdots \composeL l_n}{\amod{i}}
%	\end{array}
	\for{s \in F}\for{s_0 \in F_0} s \composeL s_0 \text{ is defined} \implies \extendsAMUpto{\amod{}' \cup \{\amod{0}\}}{(m-1)}{s_0}{s}{\amod{0}}
	\tag{I.H} \label{LAW:I.H}
\end{align}
\textbf{Show } 
%
\begin{align}
	\extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{m}{s_0}{s}{\amod{0}} \nonumber
\end{align}
%
That is:
%
\begin{align}
	&\begin{array}{l}
		\for{\ca{}, c, d, s_3, s_4}\for{(s_1 \composeL e, s_2 \composeL e) \in \amod{0}(\ca{})} \\
	\hspace*{0.2cm}\left(\for{l'} l' \leq s_1 \land l' \leq s_2 \implies l' = \unitL\right) \;\land\; s_1 \composeL e \leq  l_1 \composeL \cdots \composeL l_n \implies\\
	\hspace*{0.4cm} s_1 = s_3 \composeL s_4 \;\land\; s_1 \maxMeetL s_0 = s_3 \;\land\\
	\hspace*{0.4cm} s_0 = s_3 \composeL c \;\land\; l \composeL r = s_4 \composeL d \\
	\hspace*{1cm}\implies\\
	\left((s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \land
	\extendsAMUpto{\amod{}'}{(m-1)}{s_2 \composeL c}{d}{\amod{0}}\right)\\
	\lor\; s_2 \composeL c \composeL d \text{ is undefined}
	\end{array} \label{LAW:Goal8} \\\nonumber\\
	&\begin{array}{l}
		\for{\amod{L} \in L \cup \{\amod{0}\}} \for{\ca{}} \for{(l_1 \composeL f, l_2 \composeL f) \in \amod{L}(\ca{})} \\
  \hspace*{0.2cm} l_1 \composeL f \meetL l \composeL r \not= \emptyset \;\land\; \left(\for{l'} l' \leq l_0 \land l' \leq l'_0 \implies l' = \unitL\right)  \;\implies\\
  \hspace*{0.4cm}\exsts{f'} (l_1 \composeL f', l_2 \composeL f') \in \amod{0} \;\land\; l_1 \composeL f' \meetL l \composeL r \not= \emptyset\\
		\hspace*{0.4cm}\lor\;\for{c, d}  l_1 \composeL f \composeL c = l \composeL r \composeL d \implies\\
		\hspace*{1cm}
		\begin{array}{l l}
			l_2 \composeL f \composeL c \text{ is undefined}\\
			\lor\; \exsts{r'} l_2 \composeL f \composeL c = l \composeL r' \composeL d \;\land\; \left( d = \unitL \implies \extendsAMUpto{\amod{}, L \cup \{\amod{0}\}}{(m-1)}{l}{r'}{\amod{0}}\right)
		\end{array}
	\end{array} \label{LAW:Goal9}
\end{align}
%

\noindent\textbf{RTS. (\ref{LAW:Goal8})} \\
Pick an arbitrary $\amod{L}, \ca{}, l_1, l_2, c, d, s_3, s_4, s_1, s_2, e$ such that:
%
\begin{align}
	& (s_1 \composeL e, s_2 \composeL e) \in \amod{0}(\ca{}) \label{LAW:Ass5} \\
	& \left(\for{l'} l' \leq s_1 \land l' \leq s_2 \implies l' = \unitL\right) \label{LAW:Ass6}\\
	& s_1 \composeL e \leq  s_0 \composeL l \composeL r \label{LAW:Ass7}\\
	& s_1 = s_3 \composeL s_4 \label{LAW:Ass8}\\
	& s_1 \maxMeetL s_0 = s_3 \label{LAW:Ass9}\\
	& s_0 = s_3 \composeL c \label{LAW:Ass10}\\
	& s= s_4 \composeL d \label{LAW:Ass11}
\end{align}
%(\ref{LAW:Ass})
From (\ref{LAW:AssFence}) we know that $s_1 \leq s_0$ and consequently from (\ref{LAW:Ass8})-(\ref{LAW:Ass11}) and definition of $\maxMeetL$ we have:
%
\begin{align}
\begin{array}{l}
	s_3 = s_1 \\
	s_4 = \unitL\\
	s = d
\end{array} \label{LAW:Ass12}
\end{align}
%(\ref{LAW:Ass})
Consequently, from (\ref{LAW:Ass1}), (\ref{LAW:AssFence}), (\ref{LAW:Ass5})-(\ref{LAW:Ass7}), (\ref{LAW:Ass10}) and (\ref{LAW:Ass12}) we have:
%
\begin{align}
	(s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \;\lor\; s_2 \composeL c \composeL d \hspace*{0.2cm} \text{is undefined} \label{LAW:Ass13}
\end{align}
%
On the other hand, from (\ref{LAW:AssFence}), (\ref{LAW:Ass5}), (\ref{LAW:Ass8}), (\ref{LAW:Ass10}), (\ref{LAW:Ass12}) and definition of $\strictfences$ we have:
%
\begin{align}
	s_2 \composeL c \in F_0 \label{LAW:Ass14}
\end{align}
%(\ref{LAW:Ass})
%
From (\ref{LAW:AssEAM}), (\ref{LAW:Ass12})-(\ref{LAW:Ass14}) and (\ref{LAW:I.H}) we have:
%
%
\begin{align}
\begin{array}{l}
	(s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \;\land\; \extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{(m-1)}{s_2 \composeL c}{d}{\amod{0}}\\
	\;\lor\; s_2 \composeL c \composeL d \hspace*{0.2cm} \text{is undefined}
\end{array} \nonumber
\end{align}
%(\ref{LAW:Ass})
as required.\\

\noindent\textbf{RTS. (\ref{LAW:Goal9})}\\
Pick an arbitrary $\amod{L} \in L \cup \{\amod{0}\}, \ca{}, l_1, l_2, f$ such that:
%
\begin{align}
	& (l_1 \composeL f, l_2 \composeL f) \in \amod{L}(\ca{}) \label{LAW:Ass16}\\
	& l_1 \composeL f \meetL s \composeL s_0 \not= \emptyset \label{LAW:Ass17}\\
\end{align}
%
If $\amod{L} = \amod{0}$ then the desired result holds trivially. On the other hand if $\amod{L} \not= \amod{0}$, then pick an arbitrary $c, d$ such that $l_1 \composeL f \composeL c = s_0 \composeL s \composeL d$, then from (\ref{LAW:AssFence}) and ((\ref{LAW:sfence}) we know $l_1 \leq s$, that is 
%
\begin{align}
	& \exsts{e} l_1 \composeL e = s \label{LAW:contained}
\end{align}
%
and thus
%
\begin{align}
	l_1 \composeL f \composeL c = s_0 \composeL l_1 \composeL e \composeL d \nonumber
\end{align}
%
and consequently by cancellativity of separation algebras:
%
\begin{align}
	f \composeL c = s_0 \composeL e \composeL d \label{LAW:Part1}
\end{align}
%
From (\ref{LAW:Part1}) we have:
%
\begin{align}
	l_2 \composeL f \composeL c = l_2 \composeL s_0 \composeL e \composeL d \;\lor\; l_2 \composeL f \composeL c = \text{ is undefined} \nonumber
\end{align}
%
Pick $r' = l_2 \composeL e$
%
\begin{align}
	l_2 \composeL f \composeL c = \text{ is undefined} \;\lor\; \exsts{r'} l_2 \composeL f \composeL c = s_0 \composeL r' \composeL d \label{LAW:Part2}
\end{align}
%
Now assume $d = \unitL$ and $l_2 \composeL f \composeL c$ is defined, then from (\ref{LAW:contained}), (\ref{LAW:dd}) and by definition of $\strictfences$ we have:
%
\begin{align}
	l_2 \composeL e \in F \label{LAW:fenced}
\end{align}
%
and consequently by the (\ref{LAW:I.H})
%
\begin{align}
	\extendsAMUpto{\amod{}'}{(m-1)}{s_0}{r'}{\amod{0}}
\end{align}
%(\ref{LAW:Ass})
as required.
\renewcommand{\qed}{}
\end{proof}

%
\noindent\textbf{RTS. (\ref{LAW:Goal4})}\\
\begin{proof}
By induction on the number of steps $m$. Pick an arbitrary $s, s_0$ such that:
%
\begin{align}
	&s \in F \label{LAW2:Ass1}\\
	& s_0 \in F_0 \label{LAW2:Ass2}\\
	& s \composeL s_0 \text{ is defined} \label{LAW2:Ass3} 
\end{align}

\noindent\textbf{Base Case}\\
\textbf{RTS. } $\extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{0}{l}{r \composeL s_0}{\bigcup\limits_{\amod{i} \in L} \amod{i}}$\\
This holds trivially by definition of $-\downarrow_{0}$.\\

\noindent\textbf{Inductive Case}\\

\noindent\textbf{Assume}
\begin{align}
	\for{s \in F}\for{s_0 \in F_0} s \composeL s_0  \text{ is defined}  \implies \nonumber\\
	 \extendsAMUpto{\amod{}' \cup \{\amod{0}\}}{(m-1)}{s}{s_0}{\bigcup\limits_{\amod{i} \in L} \amod{i}}
	\tag{I.H} \label{LAW2:I.H}
\end{align}
\textbf{Show } 
%
\begin{align}
	\extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{m}{s}{s_0}{\bigcup\limits_{\amod{i} \in L} \amod{i}} \nonumber
\end{align}
%
That is:
%
\begin{align}
	&\begin{array}{l}
		\for{\ca{}, c, d, s_3, s_4}\for{(s_1 \composeL e, s_2 \composeL e) \in \left(\bigcup\limits_{\amod{i} \in L} \amod{i}\right)(\ca{})} \\
	\hspace*{0.2cm}\left(\for{l'} l' \leq s_1 \land l' \leq s_2 \implies l' = \unitL\right) \;\land\; s_1 \composeL e \leq  l \composeL r \composeL s_0 \implies\\
	\hspace*{0.4cm} s_1 = s_3 \composeL s_4 \;\land\; s_1 \maxMeetL l = s_3 \;\land\\
	\hspace*{0.4cm} l = s_3 \composeL c \;\land\; r \composeL s_0 = s_4 \composeL d \\
	\hspace*{1cm}\implies\\
	\left((s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \land
	\extendsAMUpto{\amod{}'}{(m-1)}{s_2 \composeL c}{d}{\amod{1}}\right)\\
	\lor\; s_2 \composeL c \composeL d \text{ is undefined}
	\end{array} \label{LAW:Goal10} \\\nonumber\\
	&\begin{array}{l}
		\for{\amod{L} \in L \cup \{\amod{0}\}} \for{\ca{}} \for{(l_1 \composeL f, l_2 \composeL f) \in \amod{L}(\ca{})} \\
  \hspace*{0.2cm} l_1 \composeL f \meetL l \composeL r \composeL s_0 \not= \emptyset \;\land\; \left(\for{l'} l' \leq l_0 \land l' \leq l'_0 \implies l' = \unitL\right)  \;\implies\\
  \hspace*{0.4cm}\exsts{f'} (l_1 \composeL f', l_2 \composeL f') \in \amod{1} \;\land\; l_1 \composeL f' \meetL l \composeL r \composeL s_0 \not= \emptyset\\
		\hspace*{0.4cm}\lor\;\for{c, d}  l_1 \composeL f \composeL c = l \composeL r \composeL s_0 \composeL d \implies\\
		\hspace*{1cm}
		\begin{array}{l l}
			l_2 \composeL f \composeL c \text{ is undefined}\\
			\lor\; \exsts{r'} l_2 \composeL f \composeL c = l \composeL r' \composeL d \;\land\; \left( d = \unitL \implies \extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{(m-1)}{l}{r'}{\amod{1}}\right)
		\end{array}
	\end{array} \label{LAW:Goal11}
\end{align}
%

\noindent\textbf{RTS. (\ref{LAW:Goal10})} \\
Pick an arbitrary $\ca{}, c, d, s_3, s_4, s_1, s_2, e$ such that:
%
\begin{align}
	& (s_1 \composeL e, s_2 \composeL e) \in \left(\bigcup\limits_{\amod{i} \in L} \amod{i}\right)(\ca{}) \label{LAW2:Ass5} \\
	& \left(\for{l'} l' \leq s_1 \land l' \leq s_2 \implies l' = \unitL\right) \label{LAW:Ass6}\\
	& s_1 \composeL e \leq  s_0 \composeL l \composeL r \label{LAW2:Ass7}\\
	& s_1 = s_3 \composeL s_4 \label{LAW2:Ass8}\\
	& s_1 \maxMeetL s = s_3 \label{LAW2:Ass9}\\
	& s = s_3 \composeL c \label{LAW2:Ass10}\\
	& s_0 = s_4 \composeL d \label{LAW2:Ass11}
\end{align}
%(\ref{LAW:Ass})
From (\ref{LAW:dd}) we know that $s_1 \leq s$ and consequently from (\ref{LAW:Ass8})-(\ref{LAW:Ass11}) and definition of $\maxMeetL$ we have:
%
\begin{align}
\begin{array}{l}
	s_3 = s_1 \\
	s_4 = \unitL\\
	s_0 = d
\end{array} \label{LAW2:Ass12}
\end{align}
%(\ref{LAW:Ass})
Consequently, from (\ref{LAW:Ass1}), (\ref{LAW:dd}), (\ref{LAW2:Ass5})-(\ref{LAW2:Ass7}), (\ref{LAW2:Ass10}) and (\ref{LAW2:Ass12}) we have:
%
\begin{align}
	(s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \;\lor\; s_2 \composeL c \composeL d \hspace*{0.2cm} \text{is undefined} \label{LAW2:Ass13}
\end{align}
%
On the other hand, from (\ref{LAW:dd}), (\ref{LAW2:Ass5}), (\ref{LAW2:Ass8}), (\ref{LAW2:Ass10}), (\ref{LAW2:Ass12}) and definition of $\strictfences$ we have:
%
\begin{align}
	s_2 \composeL c \in F \label{LAW2:Ass14}
\end{align}
%(\ref{LAW:Ass})
%
From (\ref{LAW:dd}), (\ref{LAW2:Ass12})-(\ref{LAW2:Ass14}) and (\ref{LAW2:I.H}) we have:
%
%
\begin{align}
\begin{array}{l}
	(s_1 \composeL c \composeL d, s_2 \composeL c \composeL d) \in \amod{}'(\ca{}) \;\land\; \extendsAMUpto{\amod{}', L \cup \{\amod{0}\}}{(m-1)}{s_2 \composeL c}{d}{\amod{1}}\\
	\;\lor\; s_2 \composeL c \composeL d \hspace*{0.2cm} \text{is undefined}
\end{array} \nonumber
\end{align}
%
as required.\\

\noindent\textbf{RTS. (\ref{LAW:Goal11})}\\
Pick an arbitrary $\amod{L} \in L \cup \{\amod{0}\}, \ca{}, l_1, l_2, f$ such that:
%
\begin{align}
	& (l_1 \composeL f, l_2 \composeL f) \in \amod{L}(\ca{}) \label{LAW:Ass16}\\
	& l_1 \composeL f \meetL s \composeL s_0 \not= \emptyset \label{LAW:Ass17}\\
\end{align}
%
If $\amod{L} \in L$ then the desired result holds trivially. On the other hand if $\amod{L} = \amod{0}$, then pick an arbitrary $c, d$ such that $l_1 \composeL f \composeL c = s_0 \composeL s \composeL d$, then from (\ref{LAW:AssFence}) and (\ref{LAW:sfence}) we know $l_1 \leq s_0$, that is 
%
\begin{align}
	& \exsts{e} l_1 \composeL e = s_0 \label{LAW:contained}
\end{align}
%
and thus
%
\begin{align}
	l_1 \composeL f \composeL c = s \composeL l_1 \composeL e \composeL d \nonumber
\end{align}
%
and consequently by cancellativity of separation algebras:
%
\begin{align}
	f \composeL c = s \composeL e \composeL d \label{LAW:Part1}
\end{align}
%
From (\ref{LAW:Part1}) we have:
%
\begin{align}
	l_2 \composeL f \composeL c = l_2 \composeL s \composeL e \composeL d \;\lor\; l_2 \composeL f \composeL c = \text{ is undefined} \nonumber
\end{align}
%
Pick $r' = l_2 \composeL e$
%
\begin{align}
	l_2 \composeL f \composeL c = \text{ is undefined} \;\lor\; \exsts{r'} l_2 \composeL f \composeL c = s \composeL r' \composeL d \label{LAW:Part2}
\end{align}
%
Now assume $d = \unitL$ and $l_2 \composeL f \composeL c$ is defined, then from (\ref{LAW:contained}), (\ref{LAW:AssFence}) and by definition of $\strictfences$ we have:
%
\begin{align}
	l_2 \composeL e \in F_0 \label{LAW:fenced}
\end{align}
%
and consequently by the (\ref{LAW2:I.H})
%
\begin{align}
	\extendsAMUpto{\amod{}'}{(m-1)}{s}{r'}{\bigcup\limits_{\amod{i} \in L}\amod{i}}
\end{align}
%(\ref{LAW:Ass})
as required.
\renewcommand{\qed}{}
\end{proof}



\end{proof}
\end{lemma}
