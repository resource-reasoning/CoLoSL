\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{array}
\usepackage{amsmath}
%\usepackage{amsfonts}
\usepackage{color}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}\captionsetup{compatibility=false}
\usepackage{xspace}
%\let\proof\relax 
%\let\endproof\relax
%\let\vec\relax
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage[fleqn]{mathtools}
\usepackage{empheq} % for boxes
\usepackage{proof}
%\usepackage{MnSymbol}
\usepackage{listings}
%\usepackage{alltt}
\usepackage{tikz}
%\usepackage{dashrule}
%\usepackage{enumerate}
%\usepackage{wrapfig}
\usepackage{relsize}
\usepackage{xcolor}
\usepackage{microtype}
\usepackage{mathpartir}

\input mathlig

\usepackage{seplog}
\usepackage{url}
\usepackage[colorlinks,%
  pdftitle={CoLoSL: Concurrent Local Subjective Logic},
  pdfauthor={Azalea Raad, Philippa Gardner, and Jules Villard}]{hyperref}
\hypersetup{linkcolor=black,citecolor=black,filecolor=black,urlcolor=black}


\usetikzlibrary{shapes}

\newcommand{\comment}{\color{blue!80!black}}

\lstset{%
  language=C,
  morecomment=[n][{\comment}]{/*}{*/},
  morecomment=[l][{\comment}]{//},
  morecomment=[n][{\ghost}]{[}{]},
  sensitive=true,
  mathescape=true,
  showlines=true,
  basicstyle=\normalfont\smaller\tt,
  keywordstyle=\bf,
  numbers=none,
  numberstyle=\tiny,
  numbersep=5pt,
  boxpos=t,
}

\newcommand{\azaleacomment}[1]{
\begin{center}
\fbox{\begin{minipage}{.9\columnwidth}
{\bf Azalea's comment:} {\it #1}
\end{minipage}}
\end{center}}

\newcommand{\pgcomment}[1]{
\begin{center}
\fbox{\begin{minipage}{.9\columnwidth}
{\bf Philippa's comment:} {\it #1}
\end{minipage}}
\end{center}}

\newcommand{\julescomment}[1]{
\begin{center}
\fbox{\begin{minipage}{.9\columnwidth}
{\bf Jules' comment:} {\it #1}
\end{minipage}}
\end{center}}



%%%%%%%%%%%%%%%%%%%%%%%% General Macros %%%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{definition}
\newtheorem{definition}{Definition}

\theoremstyle{lemma}
\newtheorem{lemma}{Lemma}

\newtheorem{theorem}{Theorem}

\newtheorem{property}{Property}

\newtheorem{parameter}{Parameter}

\newtheorem{proposition}{Proposition}

\newtheorem{example}{Example}

\newcommand{\blankArg}{(.)}
\newcommand{\emp}{\ensuremath{\mathsf{emp}}\xspace}

\newcommand{\colosl}{\text{CoLoSL}\xspace}
\newcommand{\fig}{Fig.~}
\newcommand{\param}{Parameter}
\newcommand{\defin}{Def.~}
\newcommand{\ex}{Example}

\newcommand{\powerset}{\mathcal{P}}

%%%%%%%%%%%%%%%%%%%%%%%% General Macros %%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\m}[1]{\mathit{#1}}
\newcommand{\p}[1]{\mathsf{#1}}

\definecolor{darkgreen}{rgb}{0, 0.35, 0}
\definecolor{darkred}{rgb}{0.85, 0, 0}
%\newcommand{\eqdef}{\stackrel{\mathrm{def}}{=}}
\newcommand{\eqdef}{\mathrel{\triangleq}}
\newcommand{\iffdef}{\mathrel{\stackrel{\mathrm{def}}{\iff}}}

\newcommand{\Nats}{\mathbb{N}}
\newcommand{\NatsPlus}{\Nats^{+}}

\newcommand{\dom}[1]{\textsf{dom}\left( #1 \right)}
\newcommand{\codom}[1]{\textsf{co-dom}\left( #1 \right)}

\newcommand{\for}[1]{\forall #1.\,}
\newcommand{\exsts}[1]{\exists #1.\,}

\newcommand{\cell}[2]{#1 \mapsto #2}
\newcommand{\pset}[1]{\powerset\left(#1 \right)}

\newcommand{\todo}{\textbf{TO DO }}
\newcommand{\note}[1]{\noindent\framebox{\parbox{\textwidth}{\textbf{Note: }#1}}}
\newcommand{\defstyle}[1]{\emph{#1}}

% inline code
\makeatletter
\newlength{\@mli}
\newcommand{\mli}[1]{%
  \settowidth{\@mli}{\lstinline/#1/}
  \hspace{-.5ex}\begin{minipage}[t]{\@mli}\lstinline/#1/\end{minipage}}
\makeatother
\newcommand{\li}[1]{\ifmmode\mbox{\mli{#1}}\else\mbox{\lstinline/#1/}\fi}
\newcommand{\tx}[1]{\text{#1}}

%%%%%%%%%%%%%%%%%%%%%%%% MODEL %%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\disjoint}{\sharp}
\newcommand{\separate}{\text{\textreferencemark}}
\newcommand{\fence}[1]{F_{#1}}
\newcommand{\fences}{\mathrel{\rhd}}
\newcommand{\strictfences}{\ensuremath{\unrhd}}
\newcommand{\compose}[1]{\ensuremath{\bullet_{#1}}}
\newcommand{\meet}[1]{\sqcap_{#1}}
\newcommand{\maxMeet}[1]{\sqcap_{#1}^{\textsf{m}}}
\newcommand{\unit}[1]{\ensuremath{\mathbf{0}_{#1}}}
\newcommand{\size}[2]{\left\lvert #1\right\rvert_{#2}}

%%%%Capabilities
\newcommand{\Caps}{\ensuremath{\mathbb{K}}}
\newcommand{\ca}[1]{\ensuremath{\kappa_{#1}}}
\newcommand{\capAss}[1]{\ensuremath{\mathcal{K}_{#1}}}
\newcommand{\composeCap}{\compose{\Caps}}
\newcommand{\meetCap}{\meet{\Caps}}
\newcommand{\maxMeetCap}{\maxMeet{\Caps}}
\newcommand{\unitCap}{\unit{\Caps}}
\newcommand{\capSize}[1]{\size{#1}{\Caps}}

%%%%Heaps
\newcommand{\Heaps}{\ensuremath{\mathbb{H}}\xspace}
\newcommand{\h}[1]{\ensuremath{h_{#1}}}
\newcommand{\heapAss}[1]{\ensuremath{\mathcal{H}_{#1}}}
\newcommand{\composeH}{\ensuremath{\compose{\Heaps}}}
\newcommand{\meetH}{\meet{\Heaps}}
\newcommand{\maxMeetH}{\maxMeet{\Heaps}}
\newcommand{\unitH}{\unit{\Heaps}}
\newcommand{\heapSize}[1]{\size{#1}{\Heaps}}
\newcommand{\reifyH}[1]{\left\lfloor #1 \right\rfloor_{\Heaps}}

%%%%Machine States
\newcommand{\MStates}{\ensuremath{\mathcal{S}}}
\newcommand{\ms}[1]{\sigma_{#1}}

%%%%Logical States
\newcommand{\LStates}{\textsf{LState}}
\newcommand{\composeL}{\compose{\textsf{L}}}
\newcommand{\composeS}{\compose{=}}
\newcommand{\meetL}{\meet{\textsf{L}}}
\newcommand{\maxMeetL}{\maxMeet{\textsf{L}}}
\newcommand{\unitL}{\unit{\textsf{L}}}
\newcommand{\heapPart}[1]{\ensuremath{#1_{\textsf{H}}}}
\newcommand{\capPart}[1]{\ensuremath{#1_{\textsf{K}}}}
\newcommand{\updateFP}[1]{\ensuremath{\mathcal{U}\left(#1\right)}}

%%%%Worlds
\newcommand{\Worlds}{\textsf{World}}
\newcommand{\composeW}{\compose{\textsf{W}}}
\newcommand{\unitW}{\unit{\textsf{W}}}
\newcommand{\localPart}[1]{#1_{\textsf{L}}}
\newcommand{\sharedPart}[1]{#1_{\textsf{S}}}
\newcommand{\amodelPart}[1]{#1_{\textsf{GA}}}
\newcommand{\amodelPartL}[1]{#1_{\textsf{LA}}}
\newcommand{\collapseW}[1]{\downarrow\left(#1\right)}
\newcommand{\contains}[2]{\textsf{contains}\left(#1, #2\right)}
\newcommand{\reifyW}[1]{\left\lfloor #1 \right\rfloor_{W}}

%%%%Action Models
\newcommand{\AMods}{\textsf{AMod}}
\newcommand{\amod}[1]{\ensuremath{\varsigma}_{#1}}
\newcommand{\composeAM}{\compose{=}}
\newcommand{\unitAM}{\unit{\textsf{A}}}


\newcommand{\extendsAM}[4]{\left(#1\right) \!\downarrow \left(#2, #3, #4\right)}
\newcommand{\extendsAMUpto}[5]{\left(#1\right) \!\downarrow_{#2} \left(#3, #4, #5\right)}
\newcommand{\expandsAM}[5]{\left(#1\right) \!\uparrow \left(#2, #3, #4, #5\right)}
\newcommand{\padAM}[1]{\left\lceil #1\right\rceil}
%\newcommand{\forwardClosure}[1]{#1^{\rightarrow}}
%\newcommand{\backwardClosure}[1]{#1^{\leftarrow}}
%\newcommand{\extendL}[1]{\left\lceil #1 \right\rceil}
%\newcommand{\expandAM}[2]{#1\!\!\uparrow_{\left(#2\right)}}
%

%%%%%%%%%%%%%%%%%%%%%%%% Programming Language%%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\skipC}{\texttt{skip}}
\newcommand{\opSem}[3]{\ensuremath{\left[\!\left| #1 \right |\! \right]_{#3}\left( #2 \right)}}
\newcommand{\Axioms}[1]{\ensuremath{\textsf{Axiom}_{#1}}}

\newcommand{\Basics}{\textsf{Basic}}
\newcommand{\bc}[1]{\ensuremath{\mathbb{BC}_{#1}}}
\newcommand{\AxiomsB}{\Axioms{\textsf{B}}}
\newcommand{\opSemB}[2]{\opSem{#1}{#2}{\textsf{B}}}

\newcommand{\Seqs}{\textsf{Seqs}}
\newcommand{\seq}[1]{\ensuremath{\mathbb{SC}_{#1}}}
\newcommand{\AxiomsSeq}{\Axioms{\textsf{S}}}
\newcommand{\opSemSeq}[2]{\opSem{#1}{#2}{\textsf{S}}}

\newcommand{\Atoms}{\textsf{Atom}}
\newcommand{\atom}[1]{\ensuremath{a_{#1}}}
\newcommand{\AxiomsA}{\Axioms{\textsf{A}}}
\newcommand{\opSemA}[2]{\opSem{#1}{#2}{\textsf{A}}}




%%%%%%%%%%%%%%%%%%%%%%%% Assertions %%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\Assertions}{\textsf{Assn}\xspace}
\newcommand{\LAssertions}{\textsf{LAssn}\xspace}
\newcommand{\KAssertions}{\textsf{KAssn}\xspace}
\newcommand{\HAssertions}{\textsf{HAssn}\xspace}
\newcommand{\IAssertions}{\textsf{IAssn}\xspace}
\newcommand{\PEnv}{\textsf{PEnv}\xspace}
\newcommand{\LEnv}{\textsf{LEnv}\xspace}
\newcommand{\penv}{\ensuremath{\Delta}\xspace}
\newcommand{\lenv}{\ensuremath{\Gamma}\xspace}
\newcommand{\sepish}{\ocon}
\newcommand{\strictsepish}{\sqcupplus}
%\newcommand{\shared}[3]{\boxed{#1}_{\; #3}^{\; #2}}
\addtolength{\fboxsep}{-1.5pt}
\newcommand{\shared}[2]{\fbox{\ensuremath{#1\vphantom{Qq}}}_{\; {#2}}}
\newcommand{\swap}{\mathrel{\leadsto}}
\newcommand{\ewand}{\septraction}
\newcommand{\interAss}[4]{\ensuremath{#1: \left\{ \exsts{#2} #3 \swap #4 \right\} }}
\newcommand{\multiInterAss}[5]{\ensuremath{\overline{#1: \left\{ \exsts{#2} #3 \swap #4 \right\} }}}

\newcommand{\strengthenAction}[2]{\left\lceil #1 \right\rceil^{#2}}
\newcommand{\weakenAction}[2]{\left\lfloor #1 \right\rfloor_{#2}}
\newcommand{\shiftAction}[2]{\left\lvert #1\right\rvert^{#2}}
\newcommand{\shiftInterference}[2]{\left\lvert #1\right\rvert^{#2}}

\newcommand{\token}[1]{\ensuremath{\mathsf{#1}}\xspace}

\newcommand{\hoare}[3]{\vdash\,\{#1\}\;#2\;\{#3\}}
%% Inference rules
\newcommand{\infrulestyle}[1]{\textsc{#1}}
\newcommand{\SideCondition}[1]{\RightLabel{\scriptsize{#1}}}
\renewcommand{\TirName}[1]{#1}
\renewcommand{\RefTirName}[1]{#1}
%\newcommand{\infrulelabel}[1]{\mbox{\normalfont\small\textsc{#1}}}
\newcommand{\infrule}[5][]{{\inferrule*[#1,lab=\infrulestyle{#2},right=\mathrlap{\text{#5}}]
                        {#3}{#4}}}
\newcommand{\infruleR}[5][]{{\inferrule*[#1,lab=\infrulestyle{#2},right=\text{#5}]
                        {#3}{#4}}}
\newcommand{\infruleL}[5][]{{\inferrule*[#1,lab=\infrulestyle{#2},left=\mathllap{\text{#5}}]
                        {#3}{#4}}}
\newcommand{\infruleBC}[4]{\infrule{#1}{#2}{#3\\\\\rule{0pt}{3ex}
                          {}^\dagger#4}{${}^\dagger$}}



%%%%%%%%%%%%%%%%%%%%%%%% Semantics %%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\wf}[1]{\ensuremath{\textsf{wf}\left( #1 \right)}}
%\newcommand{\precise}[1]{\ensuremath{\textsf{precise} \left( #1 \right)}}
\newcommand{\exact}[1]{\ensuremath{\textsf{exact} \left( #1 \right)}}
\newcommand{\semH}[2][\lenv]{\llparenthesis {#2} \rrparenthesis_{#1}^{H}}
\newcommand{\semK}[2][\lenv]{\llparenthesis #2 \rrparenthesis_{#1}^{K}}
\newcommand{\semL}[2][\lenv]{\llparenthesis #2 \rrparenthesis_{#1}^{\textsf{L}}}
\newcommand{\semI}[2][\lenv]{\left\langle \hspace*{-1.9pt}\left| #2 \right| \hspace*{-1.9pt} \right\rangle_{#1}}
\newcommand{\intermediateSemI}[1]{\ensuremath{\llparenthesis #1 \rrparenthesis}}
\newcommand{\intermediateSem}[2][\lenv]{\llparenthesis #2 \rrparenthesis_{#1}}
\newcommand{\sem}[2][\lenv]{\llbracket #2 \rrbracket_{#1}}
\newcommand{\sentails}{\Vvdash}
%
%%%%%%%%%%%%%%%%%%%%%%%% Soundness %%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\guarantee}{\ensuremath{G}}
\newcommand{\extendG}{\ensuremath{G^{\textsf{e}}}}
\newcommand{\shiftG}{\ensuremath{G^{\textsf{s}}}}
\newcommand{\updateG}{\ensuremath{G^{\textsf{u}}}}

\newcommand{\rely}{\ensuremath{R}}
\newcommand{\extendR}{\ensuremath{R^{\textsf{e}}}}
\newcommand{\shiftR}{\ensuremath{R^{\textsf{s}}}}
\newcommand{\updateR}{\ensuremath{R^{\textsf{u}}}}

\newcommand{\repartitions}[4]{\ensuremath{#1\semimplies^{\left\{#3\right\}\left\{#4\right\}}#2}}
%\newcommand{\viewshift}[1]{\sqsubseteq^{#1}}
\newcommand{\weakenI}[1]{\sqsubseteq^{#1}}
\newcommand{\weakenIb}[1]{\sqsubseteq_{#1}}
\newcommand{\containI}{\mathrel{\copyright}}
%\newcommand{\entangleI}[1]{\bowtie^{#1}}
\newcommand{\agrees}{\bowtie}
\newcommand{\respects}{\ltimes}
\newcommand{\local}[2]{\textsf{local}\left(#1, #2\right)}
\newcommand{\extend}[1]{\left\lceil #1 \right\rceil}
\newcommand{\stable}[1]{\ensuremath{\textsf{Stable}\left(#1\right)}}
\newcommand{\extendAM}[2]{\left\lceil #1 \right\rceil^{#2}}
\newcommand{\semimplies}{\ensuremath{\Rrightarrow}}
%
%%%%%%%%%%%%%%%%%%%%%%%% Programming Language %%%%%%%%%%%%%%%%%%%%%%%%
%
\newcommand{\atomic}[1]{\ensuremath{\left\langle #1 \right\rangle}}

\AtBeginDocument{
  %% ligatures
  % to be safe, use only characters from the following list:
  % ` " ' ~ ! ? @ * ( ) [ ] < > - + = | : ; . , / 0 1 2 3 4 5 6 7 8 9
  % each lig must be defined after all ligs it prefixes
  \mathlig{<==>}{\mathrel{\Longleftrightarrow}} % equivalence
  \mathlig{--->}{\mathrel{\longrightarrow}} % transitions
  % 3 chars
  %\mathlig{::=}{\mathrel{\Coloneqq}}
  \mathlig{-->}{\mathrel{\rightarrow}} % set function space
  \mathlig{<->}{\mathrel{\leftrightarrow}}
  \mathlig{-|}{\dashv}
  \mathlig{--`}{\mathrel{\rightharpoonup}} % partial function
  \mathlig{===}{\mathrel{\equiv}} % syntactic equality
  \mathlig{=/=}{\mathrel{\not\equiv}} % not syntactic equality
  \mathlig{|/-}{\nvdash} % not entailment
  \mathlig{|/=}{\nvDash} % not forces
  \mathlig{<=>}{\mathrel{\Leftrightarrow}} % equivalence of expressions
  \mathlig{==>}{\mathrel{\Rightarrow}} % meta implication
  \mathlig{|||}{\mathrel{|}} % grammar
  \mathlig{-|-}{\mathrel{\mathrlap{\dashv} \hspace{5pt} \vdash}} % entails
  % 2 chars
%  \mathlig{==}{\mathrel{\stackrel{\smash{\scriptscriptstyle\mathrm{def}}}{=}}}
 \mathlig{==}{\mathrel{\triangleq}}
  \mathlig{/|}{\mathbin{\wedge}} % additive conjunction
  \mathlig{|/}{\mathbin{\vee}} % additive disjunction
  \mathlig{/=}{\mathrel{\neq}} % non-equality expression
  \mathlig{<=}{\mathord{\leq}} % less than or equal expression
  \mathlig{=>}{\mathrel{\Rightarrow}} % implication
  \mathlig{|-}{\mathrel{\vdash}} % entails
  \mathlig{|=}{\vDash} % models
  \mathlig{|>}{\vartriangleright}
  \mathlig{<|}{\vartriangleleft}
  \mathlig{[|}{\llbracket} % open double bracket
  \mathlig{|]}{\rrbracket} % close double bracket
  \mathlig{->}{\mathord{\rightarrow}} % field dereference
  \mathlig{<-}{\mathord{\leftarrow}} % assignement
  \mathlig{||}{\mathbin{\parallel}}
  % 1 char  WARNING: change standard spacing
}
